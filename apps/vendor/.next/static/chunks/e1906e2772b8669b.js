(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,43432,63488,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],71689);let a=(0,t.default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>a],43432);let r=(0,t.default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>r],63488)},61346,e=>{"use strict";var t=e.i(43476),s=e.i(71645);e.i(41644);var a=e.i(2795);e.i(16233);var r=e.i(18951),l=e.i(45959),i=e.i(50610),n=e.i(64526),d=e.i(35131),o=e.i(31278),c=e.i(75254);let m=(0,c.default)("receipt-text",[["path",{d:"M13 16H8",key:"wsln4y"}],["path",{d:"M14 8H8",key:"1l3xfs"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"M4 3a1 1 0 0 1 1-1 1.3 1.3 0 0 1 .7.2l.933.6a1.3 1.3 0 0 0 1.4 0l.934-.6a1.3 1.3 0 0 1 1.4 0l.933.6a1.3 1.3 0 0 0 1.4 0l.933-.6a1.3 1.3 0 0 1 1.4 0l.934.6a1.3 1.3 0 0 0 1.4 0l.933-.6A1.3 1.3 0 0 1 19 2a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1 1.3 1.3 0 0 1-.7-.2l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.934.6a1.3 1.3 0 0 1-1.4 0l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-1.4 0l-.934-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-.7.2 1 1 0 0 1-1-1z",key:"ycz6yz"}]]);var x=e.i(78745),x=x,u=e.i(37727),h=e.i(71689);let p=(0,c.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var j=e.i(46696),f=e.i(22016),v=e.i(18566),g=e.i(20341),N=e.i(54803),b=e.i(78583),y=e.i(43432),w=e.i(63488);let _=(0,c.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);function C(){let{user:e,loading:c}=(0,g.useAuth)(),C=(0,v.useRouter)(),[q,k]=(0,s.useState)([]),[D,T]=(0,s.useState)(!0),[S,R]=(0,s.useState)(null),[A,B]=(0,s.useState)("active"),[F,M]=(0,s.useState)(null),[H,L]=(0,s.useState)(!1),[P,Q]=(0,s.useState)(!1),[z,E]=(0,s.useState)(null),[V,$]=(0,s.useState)(!1),[O,Y]=(0,s.useState)(!1),[K,U]=(0,s.useState)(""),W=e=>{M(e),L(!0)};(0,s.useEffect)(()=>{c||e?e&&X():C.push("/auth/login")},[e,c,C]);let X=async()=>{try{let e=await a.quoteService.getMyQuotes();k(e)}catch(e){console.error("Failed to fetch quotes",e),j.toast.error("Failed to load quotes.")}finally{T(!1)}},I=async e=>{M(e),Q(!0),$(!0);try{let t=await a.quoteService.getQuoteContact(e.id);E(t)}catch(t){console.error("Failed to fetch contact info",t);let e=t.response?.data?.error||"Failed to fetch contact information.";j.toast.error(e),$(!1)}finally{Q(!1)}},G=async()=>{if(!F)return;let e=F.id;R(e+"-revision");try{await a.quoteService.requestRevision(e,K),j.toast.success("Revision requested successfully!"),Y(!1),L(!1),U(""),await X()}catch(e){console.error(e),j.toast.error("Failed to request revision.")}finally{R(null)}},J=async e=>{R(e+"-accept");try{await a.quoteService.acceptQuote(e),j.toast.success("Quote accepted successfully!"),L(!1),await X()}catch(e){console.error(e),j.toast.error("Failed to accept quote.")}finally{R(null)}},Z=async e=>{R(e+"-reject");try{await a.quoteService.rejectQuote(e),j.toast.success("Quote rejected."),L(!1),await X()}catch(e){console.error(e),j.toast.error("Failed to reject quote.")}finally{R(null)}};return c||D?(0,t.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,t.jsx)(r.Navbar,{}),(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsx)(o.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}),(0,t.jsx)(l.Footer,{})]}):(0,t.jsxs)("div",{className:"flex min-h-screen flex-col bg-slate-50 dark:bg-slate-950",children:[(0,t.jsx)(r.Navbar,{}),(0,t.jsxs)("main",{className:"flex-1 container mx-auto px-4 py-8 max-w-6xl",children:[(0,t.jsxs)("div",{className:"mb-6 flex items-center gap-4",children:[(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,t.jsx)(f.default,{href:"/dashboard",children:(0,t.jsx)(h.ArrowLeft,{className:"h-4 w-4"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"My Quotes"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage quotes you have requested from vendors."})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 mb-6 border-b pb-1",children:[(0,t.jsxs)("button",{onClick:()=>B("active"),className:`pb-2 px-4 transition-colors relative ${"active"===A?"text-primary font-semibold":"text-muted-foreground"}`,children:["Active Quotes","active"===A&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-primary rounded-full"})]}),(0,t.jsxs)("button",{onClick:()=>B("archived"),className:`pb-2 px-4 transition-colors relative ${"archived"===A?"text-primary font-semibold":"text-muted-foreground"}`,children:["Archived","archived"===A&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-primary rounded-full"})]})]}),(0,t.jsx)("div",{className:"bg-white dark:bg-slate-900 rounded-xl border shadow-sm overflow-hidden",children:0===q.filter(e=>"active"===A?"archived"!==e.status:"archived"===e.status).length?(0,t.jsxs)("div",{className:"flex min-h-[300px] flex-col items-center justify-center text-center p-8 animate-in fade-in-50",children:[(0,t.jsx)("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-primary/10",children:(0,t.jsx)(m,{className:"h-6 w-6 text-primary"})}),(0,t.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No Quotes Found"}),(0,t.jsx)("p",{className:"mb-4 mt-2 text-sm text-muted-foreground max-w-sm",children:"active"===A?"You don't have any active quote requests at the moment.":"You don't have any archived or expired quotes."}),"active"===A&&(0,t.jsx)(i.Button,{asChild:!0,children:(0,t.jsx)(f.default,{href:"/vendors",children:"Find Vendors"})})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{className:"bg-muted/50",children:(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableHead,{children:"Vendor"}),(0,t.jsx)(n.TableHead,{children:"Event"}),(0,t.jsx)(n.TableHead,{children:"Requested Budget"}),(0,t.jsx)(n.TableHead,{children:"Created"}),(0,t.jsx)(n.TableHead,{children:"Quoted Price"}),(0,t.jsx)(n.TableHead,{children:"Status"}),(0,t.jsx)(n.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(n.TableBody,{children:q.filter(e=>"active"===A?"archived"!==e.status:"archived"===e.status).map(e=>{let s=e.vendor_name||e.vendor_id,a=e.event_title||e.event_id;return(0,t.jsxs)(n.TableRow,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>W(e),children:[(0,t.jsx)(n.TableCell,{className:"font-medium",children:s}),(0,t.jsx)(n.TableCell,{children:a}),(0,t.jsx)(n.TableCell,{className:"text-sm text-muted-foreground whitespace-nowrap",children:e.budget_range||"-"}),(0,t.jsx)(n.TableCell,{className:"text-muted-foreground whitespace-nowrap",children:e.created_at?new Date(e.created_at).toLocaleDateString():"-"}),(0,t.jsx)(n.TableCell,{className:"font-semibold",children:e.quoted_price?`₹${e.quoted_price}`:"Pending response"}),(0,t.jsxs)(n.TableCell,{children:[(0,t.jsx)(d.Badge,{variant:"accepted"===e.status?"default":"rejected"===e.status?"destructive":"responded"===e.status?"secondary":("archived"===e.status||e.status,"outline"),className:"capitalize",children:"archived"===e.status?"Contact Expired":e.status.replace("_"," ")}),"accepted"===e.status&&e.contact_expires_at&&(0,t.jsxs)("p",{className:"text-[10px] text-orange-600 mt-1 font-medium",children:["Access expires: ",new Date(e.contact_expires_at).toLocaleDateString()]})]}),(0,t.jsx)(n.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:["accepted"===e.status&&(0,t.jsxs)(i.Button,{size:"sm",variant:"outline",className:"h-8 shadow-none text-green-600 hover:text-green-700 hover:bg-green-50",onClick:t=>{t.stopPropagation(),I(e)},children:[(0,t.jsx)(y.Phone,{className:"h-4 w-4 mr-2"}),"Contact"]}),(0,t.jsxs)(i.Button,{size:"sm",variant:"ghost",className:"h-8 shadow-none",onClick:t=>{t.stopPropagation(),W(e)},children:[(0,t.jsx)(p,{className:"h-4 w-4 mr-2"}),"View"]})]})})]},e.id)})})]})})}),(0,t.jsx)(N.Dialog,{open:H,onOpenChange:L,children:(0,t.jsxs)(N.DialogContent,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(N.DialogHeader,{children:[(0,t.jsx)(N.DialogTitle,{children:"Quote Details"}),(0,t.jsx)(N.DialogDescription,{children:"Review the quote response from the vendor."})]}),F&&(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Vendor"}),(0,t.jsx)("p",{className:"font-medium",children:F.vendor_name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Event"}),(0,t.jsx)("p",{className:"font-medium",children:F.event_title})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Your Message"}),(0,t.jsx)("div",{className:"bg-muted p-3 flex rounded-md text-sm whitespace-pre-wrap",children:F.message||"No message provided."})]}),(0,t.jsxs)("div",{className:"pt-4 border-t",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("h4",{className:"font-semibold text-base",children:"Vendor Response"}),(0,t.jsx)(d.Badge,{variant:"accepted"===F.status?"default":"rejected"===F.status?"destructive":"responded"===F.status?"secondary":("archived"===F.status||F.status,"outline"),className:"capitalize",children:"archived"===F.status?"Contact Expired":F.status.replace("_"," ")})]}),"accepted"===F.status&&F.contact_expires_at&&(0,t.jsxs)("div",{className:"bg-orange-50 border border-orange-100 p-2 rounded-md mb-4 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-orange-600 animate-pulse"}),(0,t.jsxs)("p",{className:"text-[11px] text-orange-700 font-medium",children:["Contact access will expire on ",new Date(F.contact_expires_at).toLocaleDateString()," (",new Date(F.contact_expires_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),")"]})]}),"archived"===F.status&&(0,t.jsxs)("div",{className:"bg-slate-50 border border-slate-200 p-2 rounded-md mb-4 flex items-center gap-2",children:[(0,t.jsx)(u.X,{className:"h-3 w-3 text-slate-500"}),(0,t.jsx)("p",{className:"text-[11px] text-slate-600 font-medium",children:"This quote has been archived. Contact access is no longer available."})]}),"pending"===F.status?(0,t.jsx)("p",{className:"text-sm text-muted-foreground italic mt-2",children:"The vendor has not responded yet."}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Requested Budget"}),(0,t.jsx)("p",{className:"font-semibold",children:F.budget_range||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Quoted Price"}),(0,t.jsx)("p",{className:"font-semibold",children:F.quoted_price?`₹${F.quoted_price}`:"Pending"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Message from Vendor"}),(0,t.jsx)("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-md text-sm whitespace-pre-wrap",children:F.vendor_response||"No response details."})]}),F.attachment_url&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Attachment"}),(0,t.jsxs)("a",{href:F.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center p-3 border rounded-md hover:bg-muted/50 transition-colors group",children:[(0,t.jsx)(b.FileText,{className:"h-5 w-5 text-primary mr-2"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"View Quote Attachment"})]})]}),F.responded_at&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Responded on ",new Date(F.responded_at).toLocaleString()]})]})]}),(F.special_requirements||F.deadline)&&(0,t.jsxs)("div",{className:"pt-4 border-t space-y-3",children:[(0,t.jsx)("h4",{className:"font-semibold text-sm uppercase tracking-wider text-muted-foreground",children:"Request Details"}),F.special_requirements&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Special Requirements"}),(0,t.jsx)("p",{className:"text-sm",children:F.special_requirements})]}),F.deadline&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Required By"}),(0,t.jsx)("p",{className:"text-sm",children:new Date(F.deadline).toLocaleDateString()})]})]})]}),F?.status==="responded"&&(0,t.jsxs)(N.DialogFooter,{className:"flex flex-col sm:flex-row gap-2",children:[(0,t.jsxs)(i.Button,{type:"button",variant:"outline",disabled:!!S,onClick:()=>Y(!0),className:"flex-1",children:[(0,t.jsx)(p,{className:"h-4 w-4 mr-2"}),"Request Revision"]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-1",children:[(0,t.jsxs)(i.Button,{type:"button",variant:"outline",disabled:!!S,onClick:()=>Z(F.id),className:"flex-1 text-red-600 hover:text-red-700 hover:bg-red-50",children:[S===F.id+"-reject"?(0,t.jsx)(o.Loader2,{className:"h-4 w-4 animate-spin mr-2"}):(0,t.jsx)(u.X,{className:"h-4 w-4 mr-2"}),"Reject"]}),(0,t.jsxs)(i.Button,{type:"button",disabled:!!S,onClick:()=>J(F.id),className:"flex-1",children:[S===F.id+"-accept"?(0,t.jsx)(o.Loader2,{className:"h-4 w-4 animate-spin mr-2"}):(0,t.jsx)(x.default,{className:"h-4 w-4 mr-2"}),"Accept"]})]})]}),F?.status==="accepted"&&(0,t.jsx)(N.DialogFooter,{children:(0,t.jsxs)(i.Button,{className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>I(F),children:[(0,t.jsx)(y.Phone,{className:"h-4 w-4 mr-2"}),"Contact Vendor"]})})]})}),(0,t.jsx)(N.Dialog,{open:V,onOpenChange:$,children:(0,t.jsxs)(N.DialogContent,{className:"sm:max-w-[400px]",children:[(0,t.jsxs)(N.DialogHeader,{children:[(0,t.jsx)(N.DialogTitle,{children:"Vendor Contact Information"}),(0,t.jsxs)(N.DialogDescription,{children:["Secure communication unlocked for ",F?.vendor_name]}),F?.contact_expires_at&&(0,t.jsxs)("div",{className:"mt-2 text-[10px] font-semibold text-orange-600 uppercase tracking-tight",children:["Expires on ",new Date(F.contact_expires_at).toLocaleString()]})]}),P?(0,t.jsx)("div",{className:"py-12 flex justify-center",children:(0,t.jsx)(o.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):z?(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center p-3 border rounded-lg bg-green-50/50 border-green-100",children:[(0,t.jsx)(_,{className:"h-5 w-5 text-green-600 mr-3"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground uppercase font-semibold",children:"WhatsApp"}),(0,t.jsx)("a",{href:z.vendor.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium hover:underline text-green-700",children:"Click to chat on WhatsApp"})]})]}),(0,t.jsxs)("div",{className:"flex items-center p-3 border rounded-lg",children:[(0,t.jsx)(y.Phone,{className:"h-5 w-5 text-primary mr-3"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground uppercase font-semibold",children:"Phone Number"}),(0,t.jsx)("a",{href:`tel:${z.vendor.phone}`,className:"text-sm font-medium hover:underline",children:z.vendor.phone||"Not provided"})]})]}),(0,t.jsxs)("div",{className:"flex items-center p-3 border rounded-lg",children:[(0,t.jsx)(w.Mail,{className:"h-5 w-5 text-primary mr-3"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground uppercase font-semibold",children:"Email Address"}),(0,t.jsx)("a",{href:`mailto:${z.vendor.email}`,className:"text-sm font-medium hover:underline",children:z.vendor.email||"Not provided"})]})]})]}),(0,t.jsx)("div",{className:"p-3 bg-blue-50/50 border border-blue-100 rounded-lg",children:(0,t.jsxs)("p",{className:"text-xs text-blue-700 leading-relaxed",children:[(0,t.jsx)("strong",{children:"Pro-tip:"})," Mention your Event Name (",F?.event_title,") when contacting the vendor to help them identify your request."]})})]}):(0,t.jsx)("div",{className:"py-8 text-center text-sm text-muted-foreground",children:"Failed to load contact information."}),(0,t.jsx)(N.DialogFooter,{children:(0,t.jsx)(i.Button,{variant:"ghost",onClick:()=>$(!1),className:"w-full",children:"Close"})})]})}),(0,t.jsx)(N.Dialog,{open:O,onOpenChange:Y,children:(0,t.jsxs)(N.DialogContent,{className:"sm:max-w-[425px]",children:[(0,t.jsxs)(N.DialogHeader,{children:[(0,t.jsx)(N.DialogTitle,{children:"Request Revision"}),(0,t.jsx)(N.DialogDescription,{children:"Tell the vendor what you'd like them to adjust (e.g., lower price, change dates, or add services)."})]}),(0,t.jsx)("div",{className:"py-4",children:(0,t.jsx)("textarea",{className:"w-full min-h-[120px] p-3 rounded-md border bg-slate-50 dark:bg-slate-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"Example: Could you provide a breakdown for the equipment costs? Also, is there any flexibility on the setup time?",value:K,onChange:e=>U(e.target.value)})}),(0,t.jsxs)(N.DialogFooter,{children:[(0,t.jsx)(i.Button,{variant:"ghost",onClick:()=>Y(!1),disabled:!!S,children:"Cancel"}),(0,t.jsxs)(i.Button,{onClick:G,disabled:!!S||!K.trim(),children:[S?.includes("revision")&&(0,t.jsx)(o.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Send Request"]})]})]})})]}),(0,t.jsx)(l.Footer,{})]})}e.s(["default",()=>C],61346)}]);