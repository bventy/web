module.exports=[16344,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(95245),e=a.i(59501),f=a.i(54714);a.i(56120);var g=a.i(62917),h=a.i(79059),i=a.i(43328),j=a.i(78616);a.i(99711);var k=a.i(24607),l=a.i(27759),m=a.i(96221);let n=(0,a.i(70106).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var o=a.i(45346),p=a.i(17731),q=a.i(27707),r=a.i(11703),s=a.i(23292),t=a.i(50944),u=a.i(67327),v=a.i(84520);let w=f.object({full_name:f.string().min(2,{message:"Full name must be at least 2 characters."}),username:f.string().min(3,{message:"Username must be at least 3 characters."}).regex(/^[a-zA-Z0-9_]+$/,{message:"Username can only contain letters, numbers, and underscores."}),phone:f.string().optional(),city:f.string().optional(),bio:f.string().max(300,{message:"Bio must not be longer than 300 characters."}).optional(),profile_image_url:f.string().url({message:"Please enter a valid URL."}).optional().or(f.literal(""))});function x(){let{user:a,loading:f,refetch:x}=(0,k.useAuth)(),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),C=(0,t.useRouter)(),D=(0,d.useForm)({resolver:(0,e.zodResolver)(w),defaultValues:{full_name:"",username:"",phone:"",city:"",bio:"",profile_image_url:""}});async function E(a){z(!0);try{let b={},c=a.profile_image_url;if(A)try{c=await v.mediaService.uploadMedia(A)}catch(a){console.error("Failed to upload profile image",a),s.toast.error("Failed to upload profile image"),z(!1);return}b.full_name=a.full_name,b.username=a.username,a.phone&&""!==a.phone.trim()&&(b.phone=a.phone.replace(/\s/g,"")),a.city&&""!==a.city.trim()&&(b.city=a.city),a.bio&&""!==a.bio.trim()&&(b.bio=a.bio),c&&""!==c.trim()&&(b.profile_image_url=c),await l.userService.updateProfile(b),s.toast.success("Profile updated successfully"),window.location.reload()}catch(a){console.error("Profile update error object:",a),console.error("Profile update response data:",a.response?.data),a.response?.data?.message?s.toast.error(a.response.data.message):a.response?.data?.error?s.toast.error(a.response.data.error):"string"==typeof a.response?.data?s.toast.error(`Error: ${a.response.data.slice(0,50)}`):s.toast.error(`Failed to update profile. Status: ${a.response?.status}`)}finally{z(!1)}}return((0,c.useEffect)(()=>{a&&D.reset({full_name:a.full_name||"",username:a.username||"",phone:a.phone||"",city:a.city||"",bio:a.bio||"",profile_image_url:a.profile_image_url||""})},[a,D]),f)?(0,b.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,b.jsx)(o.Navbar,{}),(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,b.jsx)(m.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}),(0,b.jsx)(p.Footer,{})]}):a?(0,b.jsxs)("div",{className:"flex min-h-screen flex-col bg-slate-50 dark:bg-slate-950",children:[(0,b.jsx)(o.Navbar,{}),(0,b.jsxs)("main",{className:"flex-1 container mx-auto px-4 py-12 max-w-4xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Your Profile"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your personal information and public profile."})]}),(0,b.jsxs)("div",{className:"grid gap-8 md:grid-cols-[250px_1fr]",children:[(0,b.jsxs)(r.Card,{className:"h-fit",children:[(0,b.jsxs)(r.CardHeader,{children:[(0,b.jsx)(r.CardTitle,{children:"Profile Picture"}),(0,b.jsx)(r.CardDescription,{children:"This will be displayed on your public profile."})]}),(0,b.jsxs)(r.CardContent,{className:"flex flex-col items-center gap-4",children:[(0,b.jsxs)(q.Avatar,{className:"h-32 w-32",children:[(0,b.jsx)(q.AvatarImage,{src:D.watch("profile_image_url")||a.profile_image_url},D.watch("profile_image_url")||a.profile_image_url),(0,b.jsx)(q.AvatarFallback,{className:"text-4xl",children:(a.full_name||a.username||"U").charAt(0).toUpperCase()})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground text-center",children:"Use the form to update your image URL."})]})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsxs)(r.CardHeader,{children:[(0,b.jsx)(r.CardTitle,{children:"Personal Details"}),(0,b.jsx)(r.CardDescription,{children:"Update your personal information."})]}),(0,b.jsx)(r.CardContent,{children:(0,b.jsx)(h.Form,{...D,children:(0,b.jsxs)("form",{onSubmit:D.handleSubmit(E),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsx)(h.FormField,{control:D.control,name:"full_name",render:({field:a})=>(0,b.jsxs)(h.FormItem,{children:[(0,b.jsx)(h.FormLabel,{children:"Full Name"}),(0,b.jsx)(h.FormControl,{children:(0,b.jsx)(i.Input,{placeholder:"John Doe",...a})}),(0,b.jsx)(h.FormMessage,{})]})}),(0,b.jsx)(h.FormField,{control:D.control,name:"username",render:({field:a})=>(0,b.jsxs)(h.FormItem,{children:[(0,b.jsx)(h.FormLabel,{children:"Username"}),(0,b.jsx)(h.FormControl,{children:(0,b.jsx)(i.Input,{placeholder:"johndoe",...a})}),(0,b.jsx)(h.FormDescription,{children:"Unique handle for your profile."}),(0,b.jsx)(h.FormMessage,{})]})})]}),(0,b.jsx)(h.FormField,{control:D.control,name:"profile_image_url",render:({field:a})=>(0,b.jsxs)(h.FormItem,{children:[(0,b.jsx)(h.FormLabel,{children:"Profile Picture"}),(0,b.jsx)(h.FormControl,{children:(0,b.jsx)(u.FileUpload,{onFileSelect:a=>B(a),defaultUrl:a.value,label:"Upload Profile Picture"})}),(0,b.jsx)(h.FormDescription,{children:"Your public avatar."}),(0,b.jsx)(h.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsx)(h.FormField,{control:D.control,name:"phone",render:({field:a})=>(0,b.jsxs)(h.FormItem,{children:[(0,b.jsx)(h.FormLabel,{children:"Phone"}),(0,b.jsx)(h.FormControl,{children:(0,b.jsx)(i.Input,{placeholder:"+1 234 567 890",...a})}),(0,b.jsx)(h.FormMessage,{})]})}),(0,b.jsx)(h.FormField,{control:D.control,name:"city",render:({field:a})=>(0,b.jsxs)(h.FormItem,{children:[(0,b.jsx)(h.FormLabel,{children:"City"}),(0,b.jsx)(h.FormControl,{children:(0,b.jsx)(i.Input,{placeholder:"New York, NY",...a})}),(0,b.jsx)(h.FormMessage,{})]})})]}),(0,b.jsx)(h.FormField,{control:D.control,name:"bio",render:({field:a})=>(0,b.jsxs)(h.FormItem,{children:[(0,b.jsx)(h.FormLabel,{children:"Bio"}),(0,b.jsx)(h.FormControl,{children:(0,b.jsx)(j.Textarea,{placeholder:"Tell us a little about yourself",className:"resize-none",...a})}),(0,b.jsx)(h.FormDescription,{children:"Can be mentioned in community groups."}),(0,b.jsx)(h.FormMessage,{})]})}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(g.Button,{type:"submit",disabled:y,children:[y&&(0,b.jsx)(m.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),(0,b.jsx)(n,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})]})})})]})]})]}),(0,b.jsx)(p.Footer,{})]}):(C.push("/auth/login"),null)}a.s(["default",()=>x],16344)}];

//# sourceMappingURL=apps_app_src_app_dashboard_profile_page_tsx_ae200f1e._.js.map