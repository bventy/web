{"version":3,"sources":["../../../../../../apps/admin/src/app/admin/users/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { adminService  } from \"@bventy/services\";\nimport { UserProfile  } from \"@bventy/services\";\nimport { useAuth  } from \"@bventy/services\";\nimport { Table,\n    TableBody,\n    TableCell,\n    TableHead,\n    TableHeader,\n    TableRow,\n } from \"@bventy/ui\";\nimport { Avatar, AvatarFallback, AvatarImage  } from \"@bventy/ui\";\nimport { Select,\n    SelectContent,\n    SelectItem,\n    SelectTrigger,\n    SelectValue,\n } from \"@bventy/ui\";\nimport { Loader2 } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { Badge  } from \"@bventy/ui\";\n\nexport default function AdminUsersPage() {\n    const { user: currentUser } = useAuth();\n    const [users, setUsers] = useState<UserProfile[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    const fetchUsers = async () => {\n        try {\n            const data = await adminService.getUsers();\n            setUsers(data);\n        } catch (error) {\n            console.error(\"Failed to fetch users\", error);\n            toast.error(\"Failed to fetch users\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        fetchUsers();\n    }, []);\n\n    const handleRoleChange = async (userId: string, newRole: string) => {\n        try {\n            await adminService.updateUserRole(userId, newRole);\n            toast.success(\"User role updated\");\n            setUsers((prev) =>\n                prev.map((u) => (u.id === userId ? { ...u, role: newRole as any } : u))\n            );\n        } catch (error) {\n            console.error(\"Failed to update role\", error);\n            toast.error(\"Failed to update user role\");\n        }\n    };\n\n    if (loading) {\n        return (\n            <div className=\"flex h-full w-full items-center justify-center\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n            </div>\n        );\n    }\n\n    const canManageRoles = currentUser?.role === \"super_admin\";\n\n    return (\n        <div className=\"flex flex-col gap-4\">\n            <h1 className=\"text-3xl font-bold tracking-tight\">Users</h1>\n            <div className=\"rounded-md border\">\n                <Table>\n                    <TableHeader>\n                        <TableRow>\n                            <TableHead className=\"w-[100px]\">Avatar</TableHead>\n                            <TableHead>Start Info</TableHead>\n                            <TableHead>Email</TableHead>\n                            <TableHead>Current Role</TableHead>\n                            <TableHead className=\"text-right\">Actions</TableHead>\n                        </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                        {users.map((user) => (\n                            <TableRow key={user.id}>\n                                <TableCell>\n                                    <Avatar>\n                                        <AvatarImage\n                                            src={user.profile_image_url}\n                                            alt={user.username || user.full_name}\n                                        />\n                                        <AvatarFallback>\n                                            {(user.full_name || user.username || \"U\")\n                                                .charAt(0)\n                                                .toUpperCase()}\n                                        </AvatarFallback>\n                                    </Avatar>\n                                </TableCell>\n                                <TableCell>\n                                    <div className=\"flex flex-col\">\n                                        <span className=\"font-medium\">\n                                            {user.full_name || \"N/A\"}\n                                        </span>\n                                        <span className=\"text-xs text-muted-foreground\">\n                                            @{user.username}\n                                        </span>\n                                    </div>\n                                </TableCell>\n                                <TableCell>{user.email}</TableCell>\n                                <TableCell>\n                                    <Badge variant=\"outline\" className=\"capitalize\">\n                                        {user.role}\n                                    </Badge>\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                    {canManageRoles ? (\n                                        <Select\n                                            value={user.role}\n                                            onValueChange={(value) =>\n                                                handleRoleChange(user.id, value)\n                                            }\n                                        >\n                                            <SelectTrigger className=\"w-[130px] ml-auto\">\n                                                <SelectValue placeholder=\"Select role\" />\n                                            </SelectTrigger>\n                                            <SelectContent>\n                                                <SelectItem value=\"user\">User</SelectItem>\n                                                <SelectItem value=\"staff\">Staff</SelectItem>\n                                                <SelectItem value=\"admin\">Admin</SelectItem>\n                                                <SelectItem value=\"super_admin\">\n                                                    Super Admin\n                                                </SelectItem>\n                                            </SelectContent>\n                                        </Select>\n                                    ) : (\n                                        <span className=\"text-sm text-muted-foreground italic\">\n                                            View Only\n                                        </span>\n                                    )}\n                                </TableCell>\n                            </TableRow>\n                        ))}\n                    </TableBody>\n                </Table>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}